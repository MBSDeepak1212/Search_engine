You are given an integer sequence A1,A2,\xe2\x80\xa6,ANA1,A2,\xe2\x80\xa6,ANA_1, A_2, \\dots, A_N and integers KKK and MMM. For 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4N1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4N1 \\le i \\le j \\le N, let's define S(i,j)S(i,j)S(i, j) as the number of ways to choose exactly KKK elements of the contiguous subsequence Ai,Ai+1,\xe2\x80\xa6,AjAi,Ai+1,\xe2\x80\xa6,AjA_i, A_{i+1}, \\dots, A_j in such a way that the median of these KKK elements is \xe2\x89\xa5M\xe2\x89\xa5M\\ge M.Find the sum of S(i,j)S(i,j)S(i, j) over all i,ji,ji, j such that 1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4N1\xe2\x89\xa4i\xe2\x89\xa4j\xe2\x89\xa4N1 \\le i \\le j \\le N. Since this sum may be large, calculate it modulo 109+7109+710^9+7.